require 'rails_helper'

RSpec.describe Account, type: :model do

  context 'validations' do
    
    it 'can only have 1 business' do
      account = Account.create(email: 'test@gmail.com', password: 'testtest')
      expect { 
        Business.create(name: 'test company', account_id: account.id)
      }.to change(Business, :count).by(1)

      expect { 
        Business.create(name: 'test company 2', account_id: account.id)
      }.not_to change(Business, :count)

    end

    it 'can only have 1 developer' do

      account = Account.create(email: 'test@gmail.com', password: 'testtest')
      developer = Developer.new(
                                account: account,
                                first_name: 'test',
                                last_name: 'test',
                                title: 'test',
                                about: 'test',
                                city: 'KÃ¸benhavn'
                              )

      expect {developer.create}.to change(Developer, :count).by(1)
      expect {developer.create}.not_to change(Business, :count)

    end
  end

end